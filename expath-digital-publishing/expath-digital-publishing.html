<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Digital Publishing Module</title><link rel="stylesheet" type="text/css" href="http://www.w3.org/StyleSheets/TR/base.css" /><style type="text/css">
code           { font-family: monospace; }

div.constraint,
div.issue,
div.note,
div.notice     { margin-left: 2em; }

ol.enumar      { list-style-type: decimal; }
ol.enumla      { list-style-type: lower-alpha; }
ol.enumlr      { list-style-type: lower-roman; }
ol.enumua      { list-style-type: upper-alpha; }
ol.enumur      { list-style-type: upper-roman; }


div.exampleInner pre { margin-left: 1em;
                       margin-top: 0em; margin-bottom: 0em}
div.exampleOuter {border: 4px double gray;
                  margin: 0em; padding: 0em}
div.exampleInner { background-color: #d5dee3;
                   border-top-width: 4px;
                   border-top-style: double;
                   border-top-color: #d3d3d3;
                   border-bottom-width: 4px;
                   border-bottom-style: double;
                   border-bottom-color: #d3d3d3;
                   padding: 4px; margin: 0em }
div.exampleWrapper { margin: 4px }
div.exampleHeader { font-weight: bold;
                    margin: 4px}

      code.function { font-weight: bold; }
      code.type { font-style: italic; }
      /* h1, h2, h3 { color: #84001C; background: white } */
      /* a, :link, :visited, a:active { color: #84005C; background: white } */
      body {
        background-image: url(http://expath.org/images/logo-candidate.png);
      }
   </style></head><body><p><a href="http://expath.org/"><img src="http://expath.org/images/expath-icon.png" alt="EXPath" height="32" width="32" /></a></p><div class="head">
<h1><a name="title" id="title"></a>Digital Publishing Module</h1>
<h2><a name="w3c-doctype" id="w3c-doctype"></a>EXPath Candidate Module 12 November 2011</h2><dl><dt>This version:</dt><dd>
            <a href="http://expath.org/spec/digi-pub/20111112">http://expath.org/spec/digi-pub/20111112</a>
        </dd><dt>Latest version:</dt><dd>
		<a href="http://expath.org/spec/digi-pub">http://expath.org/spec/digi-pub</a>
        </dd><dt>Editor:</dt><dd>Claudius Teodorescu, XML Consultant</dd></dl><p>This document is also available in these non-normative formats: <a href="http://expath.org/spec/digi-pub/20111112.xml">XML</a>.</p><p class="copyright"></p></div><hr /><div>
<h2><a name="abstract" id="abstract"></a>Abstract</h2><p>This proposal provides a Digital Publishing module for XPath 2.0.
		It defines extension functions for converting from one digital format to another, to
		execute various processing operations of digital documents, etc.
		It has been designed to be compatible with XQuery 1.0 and XSLT 2.0, as well as any other standard based on XPath 2.0.</p></div><div class="toc">
<h2><a name="contents" id="contents"></a>Table of Contents</h2><p class="toc">1 <a href="#d2e52">Introduction</a><br />
    1.1 <a href="#d2e57">Namespace conventions</a><br />
    1.2 <a href="#d2e76">Error management</a><br />
2 <a href="#d2e87">General Functions</a><br />
    2.1 <a href="#d2e92">The digi-pub:get-module-metadata() Function</a><br />
        2.1.1 <a href="#d2e108">The digi-pub:module-metadata element</a><br />
    2.2 <a href="#d2e123">The digi-pub:transform() Function</a><br />
        2.2.1 <a href="#d2e166">The Formats</a><br />
        2.2.2 <a href="#d2e173">The Syntax for $transformation-formula parameter</a><br />
        2.2.3 <a href="#d2e200">The digi-pub:options element</a><br />
    2.3 <a href="#d2e215">The digi-pub:get-resource-metadata() Function</a><br />
    2.4 <a href="#d2e244">The digi-pub:set-resource-metadata() Function</a><br />
3 <a href="#d2e281">Functions for Documents in PDF Format</a><br />
    3.1 <a href="#d2e286">The digi-pub:pdf-merge() Function</a><br />
    3.2 <a href="#d2e295">The digi-pub:pdf-split() Function</a><br />
        3.2.1 <a href="#d2e328">The digi-pub:options element</a><br />
    3.3 <a href="#d2e345">The digi-pub:pdf-to-image() Function</a><br />
    3.4 <a href="#d2e353">The digi-pub:pdf-stamp() Function</a><br />
    3.5 <a href="#d2e361">The digi-pub:pdf-sign() Function</a><br />
    3.6 <a href="#d2e369">The digi-pub:pdf-encrypt() Function</a><br />
    3.7 <a href="#d2e377">The digi-pub:pdf-decrypt() Function</a><br />
    3.8 <a href="#d2e385">The digi-pub:pdf-import-page() Function</a><br />
    3.9 <a href="#d2e393">The digi-pub:pdf-export-page() Function</a><br />
    3.10 <a href="#d2e402">The digi-pub:pdf-delete-page() Function</a><br />
    3.11 <a href="#d2e410">The digi-pub:add-bookmark() Function</a><br />
4 <a href="#d2e418">Functions for images in various formats</a><br />
    4.1 <a href="#d2e423">The digi-pub:get-image-thumbnail() Function</a><br />
    4.2 <a href="#d2e431">The digi-pub:crop-image() Function</a><br />
    4.3 <a href="#d2e439">The digi-pub:scale-image() Function</a><br />
</p>
<h3><a name="appendices" id="appendices"></a>Appendices</h3><p class="toc">A <a href="#d2e448">References</a><br />
B <a href="#d2e457">Summary of Error Conditions</a><br />
</p></div><hr /><div class="body"><div class="div1">
<h2><a name="d2e52" id="d2e52"></a>1 Introduction</h2><p>This Digital Publishing module allows publishing and processing of digital documents.</p><div class="div2">
<h3><a name="d2e57" id="d2e57"></a>1.1 Namespace conventions</h3><p>The module defined by this document defines functions and elements in the namespace
                  <code>http://expath.org/ns/digi-pub</code>. In this document, the
		  <code>digi-pub</code> prefix, when used, is bound to this namespace URI.</p><p>Error codes are defined in the namespace <code>http://expath.org/ns/error</code>. In
               this document, <code>err</code> prefix, when used, is bound to this namespace
               URI.</p></div><div class="div2">
<h3><a name="d2e76" id="d2e76"></a>1.2 Error management</h3><p>Error conditions are identified by a code (a <code>QName</code>). When such an error
               condition is reached during the execution of the function, a dynamic error is thrown,
               with the corresponding error code (as if the standard XPath function
                  <code>error</code> had been called).</p></div></div><div class="div1">
<h2><a name="d2e87" id="d2e87"></a>2 General Functions</h2><p>These are general purpose functions, for general processing of documents, regardless their formats.</p><div class="div2">
<h3><a name="d2e92" id="d2e92"></a>2.1 The <code>digi-pub:get-module-metadata()</code> Function</h3><p>This function is used for getting the metadata of this module. It returns the module metadata.</p><div class="exampleInner"><pre>
<code class="function">digi-pub:get-module-metadata</code>() as <code class="type">element(digi-pub:module-metadata)</code>
			</pre></div><div class="div3">
<h4><a name="d2e108" id="d2e108"></a>2.1.1 The <code>digi-pub:module-metadata</code> element</h4><div class="exampleInner"><pre>
&lt;digi-pub:module-metadata&gt;
	(
	digi-pub:description,
	digi-pub:version,
	digi-pub:namespace-uri,
	digi-pub:prefix,
	digi-pub:formats
	)
&lt;/digi-pub:module-metadata&gt;
				</pre></div><ul><li><p>
						the <code>digi-pub:module-version</code> child element contains module's current version number.</p></li></ul></div></div><div class="div2">
<h3><a name="d2e123" id="d2e123"></a>2.2 The <code>digi-pub:transform()</code> Function</h3><p>This function is used to transform a document from one digital publishing format to another.</p><div class="exampleInner"><pre>
<code class="function">digi-pub:transform</code>($transformation-formula as <code class="type">xs:string</code>,
	$input-document as <code class="type">xs:anyAtomicType</code>,
	$options as <code class="type">element(digi-pub:options)?</code>) as <code class="type">xs:anyAtomicType*</code>
			</pre></div><ul><li><p><code>$transformation-formula</code> is the formula used to specify the source format and the target format. These formulae
					are detailed below. If the transformation formula is not supported,
					this is an error <a href="#errDPUB001">[err:DPUB001]</a>.</p></li><li><p><code>$input-document</code> is the document to be transformed from source format to target format.</p></li><li><p><code>$options</code> are the options for the current operation.</p></li></ul><div class="div3">
<h4><a name="d2e166" id="d2e166"></a>2.2.1 The Formats</h4><p>Below are the input/output formats:</p><p>pdf (Portable Document Format),
					html (Hypertext Markup Language), txt (Plain Text), epub
					(Open eBook), rtf (Rich Text Format),
					docbook (DocBook), xslfo (Extensible Stylesheet Language 
					Formatting Objects), pptx (PowerPoint Open XML Presentation),
					svg (Scalable Vector Graphics).</p></div><div class="div3">
<h4><a name="d2e173" id="d2e173"></a>2.2.2 The Syntax for <code>$transformation-formula</code> parameter</h4><p>The syntax for <code>$transformation-formula</code> parameter is as follows:</p></div><div class="exampleInner"><pre>
<code>$input-format</code>-to-<code>$output-format</code>
			</pre></div><p>If the syntax of the transformation formula is wrong, this is an error <a href="#errDPUB004">[err:DPUB004]</a>.</p><p>If neither the input format, or output format is supported, this is an error <a href="#errDPUB001">[err:DPUB001]</a>.</p><div class="div3">
<h4><a name="d2e200" id="d2e200"></a>2.2.3 The <code>digi-pub:options</code> element</h4><div class="exampleInner"><pre>
&lt;digi-pub:options&gt;
	(digi-pub:multiple-output?)
&lt;/digi-pub:options&gt;
				</pre></div><ul><li><p>
						the <code>digi-pub:multiple-output</code> child element controls if the output is as more
						than one documents (for value true) or as one document (for value false). The default value is false.</p></li></ul></div></div><div class="div2">
<h3><a name="d2e215" id="d2e215"></a>2.3 The <code>digi-pub:get-resource-metadata()</code> Function</h3><p>This function is used for getting the metadata of a resource. It returns the resource metadata.</p><div class="exampleInner"><pre>
<code class="function">digi-pub:get-resource-metadata</code>($resource-path as <code class="type">xs:string</code>) as <code class="type">element(digi-pub:resource-metadata)</code>
			</pre></div><ul><li><p><code>$resource-path</code> is the path of the resource. If the path is not correct,
						this is an error <a href="#errDPUB002">[err:DPUB002]</a>. If the user has no rights
						to access the path, this is an error <a href="#errDPUB003">[err:DPUB003]</a>.</p></li></ul></div><div class="div2">
<h3><a name="d2e244" id="d2e244"></a>2.4 The <code>digi-pub:set-resource-metadata()</code> Function</h3><p>This function is used for setting the metadata of a resource. It returns true if successfully completed, false if not.</p><div class="exampleInner"><pre>
<code class="function">digi-pub:set-resource-metadata</code>($resource-path as <code class="type">xs:string</code>,
	$new-resource-metadata as <code class="type">element(digi-pub:resource-metadata</code>) as <code class="type">xs:boolean</code>
			</pre></div><ul><li><p><code>$resource-path</code> is the path of the resource. If the path is not correct,
					this is an error <a href="#errDPUB002">[err:DPUB002]</a>. If the user has no rights
					to access the path, this is an error <a href="#errDPUB003">[err:DPUB003]</a>.</p></li><li><p><code>$new-resource-metadata</code> is the new resource metadata.</p></li></ul></div></div><div class="div1">
<h2><a name="d2e281" id="d2e281"></a>3 Functions for Documents in PDF Format</h2><p>These functions are designated for processing the documents in PDF format.</p><div class="div2">
<h3><a name="d2e286" id="d2e286"></a>3.1 The <code>digi-pub:pdf-merge()</code> Function</h3><p>This function is used for merging two or more (a collection of) PDF documents.</p></div><div class="div2">
<h3><a name="d2e295" id="d2e295"></a>3.2 The <code>digi-pub:pdf-split()</code> Function</h3><p>This function is used for splitting a PDF document into a number of other PDF documents.</p><div class="exampleInner"><pre>
<code class="function">digi-pub:pdf-split</code>($document as <code class="type">xs:base64Binary</code>,
	$options as <code class="type">element(digi-pub:options)</code>) as <code class="type">xs:base64Binary+</code>
			</pre></div><ul><li><p><code>$document</code> is the PDF document to be splitted.</p></li><li><p><code>$options</code> are the options for the current operation.</p></li></ul><div class="div3">
<h4><a name="d2e328" id="d2e328"></a>3.2.1 The <code>digi-pub:options</code> element</h4><div class="exampleInner"><pre>
&lt;digi-pub:options&gt;
	(digi-pub:split-delimiter+)
&lt;/digi-pub:options&gt;
				</pre></div><ul><li><p>the <code>digi-pub:split-delimiter</code> child element
						specifies the delimiter used for splitting the input PDF
						document.</p></li></ul></div></div><div class="div2">
<h3><a name="d2e345" id="d2e345"></a>3.3 The <code>digi-pub:pdf-to-image()</code> Function</h3><p>This function is used for converting a PDF document to images.</p></div><div class="div2">
<h3><a name="d2e353" id="d2e353"></a>3.4 The <code>digi-pub:pdf-stamp()</code> Function</h3><p>This function is used for adding a stamp to a PDF document.</p></div><div class="div2">
<h3><a name="d2e361" id="d2e361"></a>3.5 The <code>digi-pub:pdf-sign()</code> Function</h3><p>This function is used for digitally sign a PDF document.</p></div><div class="div2">
<h3><a name="d2e369" id="d2e369"></a>3.6 The <code>digi-pub:pdf-encrypt()</code> Function</h3><p>This function is used for encrypting a PDF document by using a digital certificate.</p></div><div class="div2">
<h3><a name="d2e377" id="d2e377"></a>3.7 The <code>digi-pub:pdf-decrypt()</code> Function</h3><p>This function is used for decrypting a PDF document.</p></div><div class="div2">
<h3><a name="d2e385" id="d2e385"></a>3.8 The <code>digi-pub:pdf-import-page()</code> Function</h3><p>This function is used for importing to a PDF document a page or more pages from a PDF document.</p></div><div class="div2">
<h3><a name="d2e393" id="d2e393"></a>3.9 The <code>digi-pub:pdf-export-page()</code> Function</h3><p>This function is used for removing a page or more pages from a PDF document.</p></div><div class="div2">
<h3><a name="d2e402" id="d2e402"></a>3.10 The <code>digi-pub:pdf-delete-page()</code> Function</h3><p>This function is used for deleting a page or more pages from a PDF document.</p></div><div class="div2">
<h3><a name="d2e410" id="d2e410"></a>3.11 The <code>digi-pub:add-bookmark()</code> Function</h3><p>This function is used to add bookmarks to a PDF document.</p></div></div><div class="div1">
<h2><a name="d2e418" id="d2e418"></a>4 Functions for images in various formats</h2><p>These functions are designated for processing the images in various formats.</p><div class="div2">
<h3><a name="d2e423" id="d2e423"></a>4.1 The <code>digi-pub:get-image-thumbnail()</code> Function</h3><p>This function is used to get a thumbnail image by scaling the main image.</p></div><div class="div2">
<h3><a name="d2e431" id="d2e431"></a>4.2 The <code>digi-pub:crop-image()</code> Function</h3><p>This function is used to remove parts of an image, in order to improve
				focus on certain detail(s), emphasize the subject or change aspect ratio.</p></div><div class="div2">
<h3><a name="d2e439" id="d2e439"></a>4.3 The <code>digi-pub:scale-image()</code> Function</h3><p>This function is used to scale (resize) an image.</p></div></div></div><div class="back"><div class="div1">
<h2><a name="d2e448" id="d2e448"></a>A References</h2><dl><dt class="label"><a name="fo11" id="fo11"></a>F&amp;O 1.1</dt><dd>
                    <a href="http://w3.org/TR/xpath-functions-11/">XPath and XQuery Functions and
				Operators 1.1</a>. Michael Kay, editor. W3C Working Draft. 15 January 2009. </dd></dl></div><div class="div1">
<h2><a name="d2e457" id="d2e457"></a>B Summary of Error Conditions</h2><dl><dt class="label"><a name="errDPUB001" id="errDPUB001"></a>err:DPUB001</dt><dd>err:DPUB001: The transformation formula is not supported.</dd><dt class="label"><a name="errDPUB002" id="errDPUB002"></a>err:DPUB002</dt><dd>err:DPUB002: The remote resource does not exist.</dd><dt class="label"><a name="errDPUB003" id="errDPUB003"></a>err:DPUB003</dt><dd>err:DPUB003: The user has no rights to access the remote resource.</dd><dt class="label"><a name="errDPUB004" id="errDPUB004"></a>err:DPUB004</dt><dd>err:DPUB004: The syntax of the transformation formula is wrong.</dd></dl></div></div></body></html>